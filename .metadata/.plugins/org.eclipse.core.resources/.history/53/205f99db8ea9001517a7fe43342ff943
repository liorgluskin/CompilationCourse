package lir;

import slp.*;
import symbolTableHandler.*;

public class LirVisitor implements PropagatingVisitor<Environment,LirReturnInfo>{
	
	private GlobalSymbolTable globalSymTable = null;
	private Environment environment = null;
	
	public LirVisitor(GlobalSymbolTable globalSymT){
		globalSymTable = globalSymT;
	}
	
	String getLirCode(Program program){
		environment = new Environment();
		visit(program,environment);
		return environment.generateLirCode();
	}

	@Override
	public LirReturnInfo visit(Program program, Environment d) {
		
		//all checks are done in Environment instance
		//therefore, nothing to be done in current visit		
		
		//visit all classes apart from Library
		for(ClassDecl c: program.getClasses()){
			if (!c.getName().equals("Library"))
				c.accept(this, d);
		}
		
		//nothing to be returned
		return null;
	}

	@Override
	public LirReturnInfo visit(ClassDecl class_decl, Environment d) {
		
		//create dispacher table
		ClassSymbolTable classSymT = globalSymTable
				.getClassSymbolTable(class_decl.getName());
		
		if(class_decl.getSuperClassName() != null){
			d.addVirtualTable(class_decl.getName(), class_decl.getSuperClassName(),
					classSymT.getAllVirtualMethods());
		}else{
			d.addVirtualTable((class_decl.getName(), classSymT.getAllVirtualMethods());
		}
		
		
		return null;
	}

	@Override
	public LirReturnInfo visit(Field field, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(StaticMethod staticMethod, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(ClassMethod classMethod, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(PrimitiveType primitiveType, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(ClassType classType, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(Formal formal, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(AssignStmt stmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(CallStmt callstmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(ReturnStmt returnStmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(IfStmt ifStmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(WhileStmt whileStmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(BreakStmt breakStmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(ContinueStmt contineStmtm, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(IDStmt idStmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(BlockStmt blockStmt, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(StmtList stmtLst, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(VarLocation var_loc, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(ArrLocation arr_loc, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(StaticCall static_call, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(VirtualCall virtual_call, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(This t, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(NewObject new_obj, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(NewArray new_arr, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(Length length, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(Literal literal, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(Expr expr, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(BlockExpr expr, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(UnaryOpExpr expr, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public LirReturnInfo visit(BinaryOpExpr expr, Environment d) {
		// TODO Auto-generated method stub
		return null;
	}

}
